# Android-specific GraphQL Types

# Android pricing phases
type PricingPhasesAndroid {
  pricingPhaseList: [PricingPhaseAndroid!]!
}

type PricingPhaseAndroid {
  formattedPrice: String!
  priceCurrencyCode: String!
  billingPeriod: String! # P1W, P1M, P1Y
  billingCycleCount: Int!
  priceAmountMicros: String!
  recurrenceMode: Int!
}

"""
Pre-order details for one-time purchase products (Android)
Available in Google Play Billing Library 8.1.0+
"""
type PreorderDetailsAndroid {
  """
  Pre-order presale end time in milliseconds since epoch.
  This is when the presale period ends and the product will be released.
  """
  preorderPresaleEndTimeMillis: String!
  """
  Pre-order release time in milliseconds since epoch.
  This is when the product will be available to users who pre-ordered.
  """
  preorderReleaseTimeMillis: String!
}

"""
Rental details for one-time purchase products that can be rented (Android)
Available in Google Play Billing Library 7.0+
"""
type RentalDetailsAndroid {
  """
  Rental period in ISO 8601 format (e.g., P7D for 7 days)
  """
  rentalPeriod: String!
  """
  Rental expiration period in ISO 8601 format
  Time after rental period ends when user can still extend
  """
  rentalExpirationPeriod: String
}

"""
Valid time window for when an offer is available (Android)
Available in Google Play Billing Library 7.0+
"""
type ValidTimeWindowAndroid {
  """
  Start time in milliseconds since epoch
  """
  startTimeMillis: String!
  """
  End time in milliseconds since epoch
  """
  endTimeMillis: String!
}

"""
Limited quantity information for one-time purchase offers (Android)
Available in Google Play Billing Library 7.0+
"""
type LimitedQuantityInfoAndroid {
  """
  Maximum quantity a user can purchase
  """
  maximumQuantity: Int!
  """
  Remaining quantity the user can still purchase
  """
  remainingQuantity: Int!
}

"""
Discount amount details for one-time purchase offers (Android)
Available in Google Play Billing Library 7.0+
"""
type DiscountAmountAndroid {
  """
  Discount amount in micro-units (1,000,000 = 1 unit of currency)
  """
  discountAmountMicros: String!
  """
  Formatted discount amount with currency sign (e.g., "$4.99")
  """
  formattedDiscountAmount: String!
}

"""
Discount display information for one-time purchase offers (Android)
Available in Google Play Billing Library 7.0+
"""
type DiscountDisplayInfoAndroid {
  """
  Percentage discount (e.g., 33 for 33% off)
  Only returned for percentage-based discounts
  """
  percentageDiscount: Int
  """
  Absolute discount amount details
  Only returned for fixed amount discounts
  """
  discountAmount: DiscountAmountAndroid
}

"""
One-time purchase offer details (Android).
Available in Google Play Billing Library 7.0+
@deprecated Use the standardized DiscountOffer type instead for cross-platform compatibility.
@see https://openiap.dev/docs/types#discount-offer
"""
type ProductAndroidOneTimePurchaseOfferDetail
  @deprecated(reason: "Use DiscountOffer type instead") {
  """
  Offer ID
  """
  offerId: String
  """
  Offer token for use in BillingFlowParams when purchasing
  """
  offerToken: String!
  """
  List of offer tags
  """
  offerTags: [String!]!
  priceCurrencyCode: String!
  formattedPrice: String!
  priceAmountMicros: String!
  """
  Full (non-discounted) price in micro-units
  Only available for discounted offers
  """
  fullPriceMicros: String
  """
  Discount display information
  Only available for discounted offers
  """
  discountDisplayInfo: DiscountDisplayInfoAndroid
  """
  Valid time window for the offer
  """
  validTimeWindow: ValidTimeWindowAndroid
  """
  Limited quantity information
  """
  limitedQuantityInfo: LimitedQuantityInfoAndroid
  """
  Pre-order details for products available for pre-order
  Available in Google Play Billing Library 8.1.0+
  """
  preorderDetailsAndroid: PreorderDetailsAndroid
  """
  Rental details for rental offers
  """
  rentalDetailsAndroid: RentalDetailsAndroid
}

"""
Subscription offer details (Android).
@deprecated Use the standardized SubscriptionOffer type instead for cross-platform compatibility.
@see https://openiap.dev/docs/types#subscription-offer
"""
type ProductSubscriptionAndroidOfferDetails
  @deprecated(reason: "Use SubscriptionOffer type instead") {
  basePlanId: String!
  offerId: String
  offerToken: String!
  offerTags: [String!]!
  pricingPhases: PricingPhasesAndroid!
}

type ProductAndroid implements ProductCommon {
  # Common fields
  id: ID!
  title: String!
  description: String!
  type: ProductType!
  displayName: String
  displayPrice: String!
  currency: String!
  price: Float
  debugDescription: String
  platform: IapPlatform!

  # Android-specific
  nameAndroid: String!

  # Standardized cross-platform fields
  """
  Standardized discount offers for one-time products.
  Cross-platform type with Android-specific fields using suffix.
  @see https://openiap.dev/docs/types#discount-offer
  """
  discountOffers: [DiscountOffer!]

  """
  Standardized subscription offers.
  Cross-platform type with Android-specific fields using suffix.
  @see https://openiap.dev/docs/types#subscription-offer
  """
  subscriptionOffers: [SubscriptionOffer!]

  # Deprecated platform-specific fields
  """
  One-time purchase offer details including discounts (Android)
  Returns all eligible offers. Available in Google Play Billing Library 7.0+
  @deprecated Use discountOffers instead for cross-platform compatibility.
  """
  oneTimePurchaseOfferDetailsAndroid: [ProductAndroidOneTimePurchaseOfferDetail!]
    @deprecated(reason: "Use discountOffers instead")
  """
  @deprecated Use subscriptionOffers instead for cross-platform compatibility.
  """
  subscriptionOfferDetailsAndroid: [ProductSubscriptionAndroidOfferDetails!]
    @deprecated(reason: "Use subscriptionOffers instead")
}

type ProductSubscriptionAndroid implements ProductCommon {
  # Common fields
  id: ID!
  title: String!
  description: String!
  type: ProductType!
  displayName: String
  displayPrice: String!
  currency: String!
  price: Float
  debugDescription: String
  platform: IapPlatform!

  # Android-specific
  nameAndroid: String!

  # Standardized cross-platform fields
  """
  Standardized discount offers for one-time products.
  Cross-platform type with Android-specific fields using suffix.
  @see https://openiap.dev/docs/types#discount-offer
  """
  discountOffers: [DiscountOffer!]

  """
  Standardized subscription offers.
  Cross-platform type with Android-specific fields using suffix.
  @see https://openiap.dev/docs/types#subscription-offer
  """
  subscriptionOffers: [SubscriptionOffer!]!

  # Deprecated platform-specific fields
  """
  One-time purchase offer details including discounts (Android)
  Returns all eligible offers. Available in Google Play Billing Library 7.0+
  @deprecated Use discountOffers instead for cross-platform compatibility.
  """
  oneTimePurchaseOfferDetailsAndroid: [ProductAndroidOneTimePurchaseOfferDetail!]
    @deprecated(reason: "Use discountOffers instead")
  """
  @deprecated Use subscriptionOffers instead for cross-platform compatibility.
  """
  subscriptionOfferDetailsAndroid: [ProductSubscriptionAndroidOfferDetails!]!
    @deprecated(reason: "Use subscriptionOffers instead")
}

type PurchaseAndroid implements PurchaseCommon {
  # Common fields
  id: ID!
  productId: String!
  ids: [String!]
  transactionId: String # Optional in Android unlike iOS
  transactionDate: Float!
  purchaseToken: String
  """
  Store where purchase was made
  """
  store: IapStore!
  platform: IapPlatform! @deprecated(reason: "Use store instead")
  quantity: Int!
  purchaseState: PurchaseState!
  isAutoRenewing: Boolean!
  currentPlanId: String

  # Android-specific fields
  dataAndroid: String
  signatureAndroid: String
  autoRenewingAndroid: Boolean
  isAcknowledgedAndroid: Boolean
  packageNameAndroid: String
  developerPayloadAndroid: String
  obfuscatedAccountIdAndroid: String
  obfuscatedProfileIdAndroid: String
  """
  Whether the subscription is suspended (Android)
  A suspended subscription means the user's payment method failed and they need to fix it.
  Users should be directed to the subscription center to resolve the issue.
  Do NOT grant entitlements for suspended subscriptions.
  Available in Google Play Billing Library 8.1.0+
  """
  isSuspendedAndroid: Boolean
}

# Android inputs
input RequestPurchaseAndroidProps {
  """
  List of product SKUs
  """
  skus: [String!]!
  """
  Obfuscated account ID
  """
  obfuscatedAccountIdAndroid: String
  """
  Obfuscated profile ID
  """
  obfuscatedProfileIdAndroid: String
  """
  Personalized offer flag
  """
  isOfferPersonalized: Boolean
  """
  Developer billing option parameters for external payments flow (8.3.0+).
  When provided, the purchase flow will show a side-by-side choice between
  Google Play Billing and the developer's external payment option.
  """
  developerBillingOption: DeveloperBillingOptionParamsAndroid
}

input RequestSubscriptionAndroidProps {
  """
  List of subscription SKUs
  """
  skus: [String!]!
  """
  Obfuscated account ID
  """
  obfuscatedAccountIdAndroid: String
  """
  Obfuscated profile ID
  """
  obfuscatedProfileIdAndroid: String
  """
  Personalized offer flag
  """
  isOfferPersonalized: Boolean
  """
  Purchase token for upgrades/downgrades
  """
  purchaseTokenAndroid: String
  """
  Replacement mode for subscription changes
  @deprecated Use subscriptionProductReplacementParams instead for item-level replacement (8.1.0+)
  """
  replacementModeAndroid: Int
  """
  Subscription offers
  """
  subscriptionOffers: [AndroidSubscriptionOfferInput!]
  """
  Product-level replacement parameters (8.1.0+)
  Use this instead of replacementModeAndroid for item-level replacement
  """
  subscriptionProductReplacementParams: SubscriptionProductReplacementParamsAndroid
  """
  Developer billing option parameters for external payments flow (8.3.0+).
  When provided, the purchase flow will show a side-by-side choice between
  Google Play Billing and the developer's external payment option.
  """
  developerBillingOption: DeveloperBillingOptionParamsAndroid
}

# Subscription Replacement (Google Play Billing Library 8.1.0+)
"""
Replacement mode for subscription changes (Android)
These modes determine how the subscription replacement affects billing.
Available in Google Play Billing Library 8.1.0+
"""
enum SubscriptionReplacementModeAndroid {
  """
  Unknown replacement mode. Do not use.
  """
  UNKNOWN_REPLACEMENT_MODE
  """
  Replacement takes effect immediately, and the new expiration time will be prorated.
  """
  WITH_TIME_PRORATION
  """
  Replacement takes effect immediately, and the billing cycle remains the same.
  """
  CHARGE_PRORATED_PRICE
  """
  Replacement takes effect immediately, and the user is charged full price immediately.
  """
  CHARGE_FULL_PRICE
  """
  Replacement takes effect when the old plan expires.
  """
  WITHOUT_PRORATION
  """
  Replacement takes effect when the old plan expires, and the user is not charged.
  """
  DEFERRED
  """
  Keep the existing payment schedule unchanged for the item (8.1.0+)
  """
  KEEP_EXISTING
}

"""
Product-level subscription replacement parameters (Android)
Used with setSubscriptionProductReplacementParams in BillingFlowParams.ProductDetailsParams
Available in Google Play Billing Library 8.1.0+
"""
input SubscriptionProductReplacementParamsAndroid {
  """
  The old product ID that needs to be replaced
  """
  oldProductId: String!
  """
  The replacement mode for this product change
  """
  replacementMode: SubscriptionReplacementModeAndroid!
}

input AndroidSubscriptionOfferInput {
  """
  Product SKU
  """
  sku: String!
  """
  Offer token
  """
  offerToken: String!
}

"""
Google Play Store verification parameters.
Used for server-side receipt validation via Google Play Developer API.

⚠️ SECURITY: Contains sensitive tokens (accessToken, purchaseToken). Do not log or persist this data.
"""
input VerifyPurchaseGoogleOptions {
  """
  Product SKU to validate
  """
  sku: String!
  """
  Android package name (e.g., com.example.app)
  """
  packageName: String!
  """
  Purchase token from the purchase response.
  ⚠️ Sensitive: Do not log this value.
  """
  purchaseToken: String!
  """
  Google OAuth2 access token for API authentication.
  ⚠️ Sensitive: Do not log this value.
  """
  accessToken: String!
  """
  Whether this is a subscription purchase (affects API endpoint used)
  """
  isSub: Boolean
}

"""
Meta Horizon (Quest) verification parameters.
Used for server-side entitlement verification via Meta's S2S API.
POST https://graph.oculus.com/$APP_ID/verify_entitlement

⚠️ SECURITY: Contains sensitive token (accessToken). Do not log or persist this data.
"""
input VerifyPurchaseHorizonOptions {
  """
  The SKU for the add-on item, defined in Meta Developer Dashboard
  """
  sku: String!
  """
  The user ID of the user whose purchase you want to verify
  """
  userId: String!
  """
  Access token for Meta API authentication (OC|$APP_ID|$APP_SECRET or User Access Token).
  ⚠️ Sensitive: Do not log this value.
  """
  accessToken: String!
}

"""
Result from Meta Horizon verify_entitlement API.
Returns verification status and grant time for the entitlement.
"""
type VerifyPurchaseResultHorizon {
  """
  Whether the entitlement verification succeeded.
  """
  success: Boolean!
  """
  Unix timestamp (seconds) when the entitlement was granted.
  """
  grantTime: Float
}

type VerifyPurchaseResultAndroid {
  autoRenewing: Boolean!
  betaProduct: Boolean!
  cancelDate: Float
  cancelReason: String
  deferredDate: Float
  deferredSku: String
  freeTrialEndDate: Float!
  gracePeriodEndDate: Float!
  parentProductId: String!
  productId: String!
  productType: String!
  purchaseDate: Float!
  quantity: Int!
  receiptId: String!
  renewalDate: Float!
  term: String!
  termSku: String!
  testTransaction: Boolean!
}

# Alternative Billing (Deprecated)
"""
Alternative billing mode for Android
Controls which billing system is used
@deprecated Use enableBillingProgramAndroid with BillingProgramAndroid instead.
Use USER_CHOICE_BILLING for user choice billing, EXTERNAL_OFFER for alternative only.
"""
enum AlternativeBillingModeAndroid {
  """
  Standard Google Play billing (default)
  """
  NONE

  """
  User choice billing - user can select between Google Play or alternative
  Requires Google Play Billing Library 7.0+
  @deprecated Use BillingProgramAndroid.USER_CHOICE_BILLING instead
  """
  USER_CHOICE

  """
  Alternative billing only - no Google Play billing option
  Requires Google Play Billing Library 6.2+
  @deprecated Use BillingProgramAndroid.EXTERNAL_OFFER instead
  """
  ALTERNATIVE_ONLY
}

# User Choice Billing
"""
User Choice Billing event details (Android)
Fired when a user selects alternative billing in the User Choice Billing dialog
"""
type UserChoiceBillingDetails {
  """
  Token that must be reported to Google Play within 24 hours
  """
  externalTransactionToken: String!
  """
  List of product IDs selected by the user
  """
  products: [String!]!
}

# External Billing Programs (Google Play Billing Library 8.2.0+)
"""
Billing program types for external content links, external offers, and external payments (Android)
Available in Google Play Billing Library 8.2.0+, EXTERNAL_PAYMENTS added in 8.3.0
"""
enum BillingProgramAndroid {
  """
  Unspecified billing program. Do not use.
  """
  UNSPECIFIED
  """
  User Choice Billing program.
  User can select between Google Play Billing or alternative billing.
  Available in Google Play Billing Library 7.0+
  """
  USER_CHOICE_BILLING
  """
  External Content Links program.
  Allows linking to external content outside the app.
  Available in Google Play Billing Library 8.2.0+
  """
  EXTERNAL_CONTENT_LINK
  """
  External Offers program.
  Allows offering digital content purchases outside the app.
  Available in Google Play Billing Library 8.2.0+
  """
  EXTERNAL_OFFER
  """
  External Payments program (Japan only).
  Allows presenting a side-by-side choice between Google Play Billing and developer's external payment option.
  Users can choose to complete the purchase on the developer's website.
  Available in Google Play Billing Library 8.3.0+
  """
  EXTERNAL_PAYMENTS
}

"""
Launch mode for external link flow (Android)
Determines how the external URL is launched
Available in Google Play Billing Library 8.2.0+
"""
enum ExternalLinkLaunchModeAndroid {
  """
  Unspecified launch mode. Do not use.
  """
  UNSPECIFIED
  """
  Play will launch the URL in an external browser or eligible app
  """
  LAUNCH_IN_EXTERNAL_BROWSER_OR_APP
  """
  Play will not launch the URL. The app handles launching the URL after Play returns control.
  """
  CALLER_WILL_LAUNCH_LINK
}

"""
Link type for external link flow (Android)
Specifies the type of external link destination
Available in Google Play Billing Library 8.2.0+
"""
enum ExternalLinkTypeAndroid {
  """
  Unspecified link type. Do not use.
  """
  UNSPECIFIED
  """
  The link will direct users to a digital content offer
  """
  LINK_TO_DIGITAL_CONTENT_OFFER
  """
  The link will direct users to download an app
  """
  LINK_TO_APP_DOWNLOAD
}

"""
Parameters for launching an external link (Android)
Used with launchExternalLink to initiate external offer or app install flows
Available in Google Play Billing Library 8.2.0+
"""
input LaunchExternalLinkParamsAndroid {
  """
  The billing program (EXTERNAL_CONTENT_LINK or EXTERNAL_OFFER)
  """
  billingProgram: BillingProgramAndroid!
  """
  The external link launch mode
  """
  launchMode: ExternalLinkLaunchModeAndroid!
  """
  The type of the external link
  """
  linkType: ExternalLinkTypeAndroid!
  """
  The URI where the content will be accessed from
  """
  linkUri: String!
}

"""
Reporting details for transactions made outside of Google Play Billing (Android)
Contains the external transaction token needed for reporting
Available in Google Play Billing Library 8.2.0+
"""
type BillingProgramReportingDetailsAndroid {
  """
  The billing program that the reporting details are associated with
  """
  billingProgram: BillingProgramAndroid!
  """
  External transaction token used to report transactions made outside of Google Play Billing.
  This token must be used when reporting the external transaction to Google.
  """
  externalTransactionToken: String!
}

"""
Result of checking billing program availability (Android)
Available in Google Play Billing Library 8.2.0+
"""
type BillingProgramAvailabilityResultAndroid {
  """
  Whether the billing program is available for the user
  """
  isAvailable: Boolean!
  """
  The billing program that was checked
  """
  billingProgram: BillingProgramAndroid!
}

# External Payments Program (Google Play Billing Library 8.3.0+)
# See: https://developer.android.com/google/play/billing/externalpaymentlinks

"""
Launch mode for developer billing option (Android)
Determines how the external payment URL is launched
Available in Google Play Billing Library 8.3.0+
"""
enum DeveloperBillingLaunchModeAndroid {
  """
  Unspecified launch mode. Do not use.
  """
  UNSPECIFIED
  """
  Google Play will launch the link in an external browser or eligible app.
  Use this when you want Play to handle launching the external payment URL.
  """
  LAUNCH_IN_EXTERNAL_BROWSER_OR_APP
  """
  The caller app will launch the link after Play returns control.
  Use this when you want to handle launching the external payment URL yourself.
  """
  CALLER_WILL_LAUNCH_LINK
}

"""
Parameters for developer billing option in purchase flow (Android)
Used with BillingFlowParams to enable external payments flow
Available in Google Play Billing Library 8.3.0+
"""
input DeveloperBillingOptionParamsAndroid {
  """
  The billing program (should be EXTERNAL_PAYMENTS for external payments flow)
  """
  billingProgram: BillingProgramAndroid!
  """
  The URI where the external payment will be processed
  """
  linkUri: String!
  """
  The launch mode for the external payment link
  """
  launchMode: DeveloperBillingLaunchModeAndroid!
}

"""
Details provided when user selects developer billing option (Android)
Received via DeveloperProvidedBillingListener callback
Available in Google Play Billing Library 8.3.0+
"""
type DeveloperProvidedBillingDetailsAndroid {
  """
  External transaction token used to report transactions made through developer billing.
  This token must be used when reporting the external transaction to Google Play.
  Must be reported within 24 hours of the transaction.
  """
  externalTransactionToken: String!
}

# Deprecated External Offers APIs (Google Play Billing Library 8.2.0)
# These APIs are deprecated in favor of the new BillingProgram APIs above

"""
External offer reporting details (Android)
@deprecated Use BillingProgramReportingDetailsAndroid with createBillingProgramReportingDetailsAsync instead
Available in Google Play Billing Library 6.2.0+, deprecated in 8.2.0
"""
type ExternalOfferReportingDetailsAndroid
  @deprecated(
    reason: "Use BillingProgramReportingDetailsAndroid with createBillingProgramReportingDetailsAsync instead"
  ) {
  """
  External transaction token for reporting external offer transactions
  """
  externalTransactionToken: String!
}

"""
External offer availability result (Android)
@deprecated Use BillingProgramAvailabilityResultAndroid with isBillingProgramAvailableAsync instead
Available in Google Play Billing Library 6.2.0+, deprecated in 8.2.0
"""
type ExternalOfferAvailabilityResultAndroid
  @deprecated(
    reason: "Use BillingProgramAvailabilityResultAndroid with isBillingProgramAvailableAsync instead"
  ) {
  """
  Whether external offers are available for the user
  """
  isAvailable: Boolean!
}
