# Android-specific GraphQL Types

# Android pricing phases
type PricingPhasesAndroid {
  pricingPhaseList: [PricingPhaseAndroid!]!
}

type PricingPhaseAndroid {
  formattedPrice: String!
  priceCurrencyCode: String!
  billingPeriod: String! # P1W, P1M, P1Y
  billingCycleCount: Int!
  priceAmountMicros: String!
  recurrenceMode: Int!
}

"""
Pre-order details for one-time purchase products (Android)
Available in Google Play Billing Library 8.1.0+
"""
type PreorderDetailsAndroid {
  """
  Pre-order presale end time in milliseconds since epoch.
  This is when the presale period ends and the product will be released.
  """
  preorderPresaleEndTimeMillis: String!
  """
  Pre-order release time in milliseconds since epoch.
  This is when the product will be available to users who pre-ordered.
  """
  preorderReleaseTimeMillis: String!
}

"""
Rental details for one-time purchase products that can be rented (Android)
Available in Google Play Billing Library 7.0+
"""
type RentalDetailsAndroid {
  """
  Rental period in ISO 8601 format (e.g., P7D for 7 days)
  """
  rentalPeriod: String!
  """
  Rental expiration period in ISO 8601 format
  Time after rental period ends when user can still extend
  """
  rentalExpirationPeriod: String
}

"""
Valid time window for when an offer is available (Android)
Available in Google Play Billing Library 7.0+
"""
type ValidTimeWindowAndroid {
  """
  Start time in milliseconds since epoch
  """
  startTimeMillis: String!
  """
  End time in milliseconds since epoch
  """
  endTimeMillis: String!
}

"""
Limited quantity information for one-time purchase offers (Android)
Available in Google Play Billing Library 7.0+
"""
type LimitedQuantityInfoAndroid {
  """
  Maximum quantity a user can purchase
  """
  maximumQuantity: Int!
  """
  Remaining quantity the user can still purchase
  """
  remainingQuantity: Int!
}

"""
Discount amount details for one-time purchase offers (Android)
Available in Google Play Billing Library 7.0+
"""
type DiscountAmountAndroid {
  """
  Discount amount in micro-units (1,000,000 = 1 unit of currency)
  """
  discountAmountMicros: String!
  """
  Formatted discount amount with currency sign (e.g., "$4.99")
  """
  formattedDiscountAmount: String!
}

"""
Discount display information for one-time purchase offers (Android)
Available in Google Play Billing Library 7.0+
"""
type DiscountDisplayInfoAndroid {
  """
  Percentage discount (e.g., 33 for 33% off)
  Only returned for percentage-based discounts
  """
  percentageDiscount: Int
  """
  Absolute discount amount details
  Only returned for fixed amount discounts
  """
  discountAmount: DiscountAmountAndroid
}

"""
One-time purchase offer details (Android)
Available in Google Play Billing Library 7.0+
"""
type ProductAndroidOneTimePurchaseOfferDetail {
  """
  Offer ID
  """
  offerId: String
  """
  Offer token for use in BillingFlowParams when purchasing
  """
  offerToken: String!
  """
  List of offer tags
  """
  offerTags: [String!]!
  priceCurrencyCode: String!
  formattedPrice: String!
  priceAmountMicros: String!
  """
  Full (non-discounted) price in micro-units
  Only available for discounted offers
  """
  fullPriceMicros: String
  """
  Discount display information
  Only available for discounted offers
  """
  discountDisplayInfo: DiscountDisplayInfoAndroid
  """
  Valid time window for the offer
  """
  validTimeWindow: ValidTimeWindowAndroid
  """
  Limited quantity information
  """
  limitedQuantityInfo: LimitedQuantityInfoAndroid
  """
  Pre-order details for products available for pre-order
  Available in Google Play Billing Library 8.1.0+
  """
  preorderDetailsAndroid: PreorderDetailsAndroid
  """
  Rental details for rental offers
  """
  rentalDetailsAndroid: RentalDetailsAndroid
}

type ProductSubscriptionAndroidOfferDetails {
  basePlanId: String!
  offerId: String
  offerToken: String!
  offerTags: [String!]!
  pricingPhases: PricingPhasesAndroid!
}

type ProductAndroid implements ProductCommon {
  # Common fields
  id: ID!
  title: String!
  description: String!
  type: ProductType!
  displayName: String
  displayPrice: String!
  currency: String!
  price: Float
  debugDescription: String
  platform: IapPlatform!

  # Android-specific
  nameAndroid: String!
  """
  One-time purchase offer details including discounts (Android)
  Returns all eligible offers. Available in Google Play Billing Library 7.0+
  """
  oneTimePurchaseOfferDetailsAndroid: [ProductAndroidOneTimePurchaseOfferDetail!]
  subscriptionOfferDetailsAndroid: [ProductSubscriptionAndroidOfferDetails!]
}

type ProductSubscriptionAndroid implements ProductCommon {
  # Common fields
  id: ID!
  title: String!
  description: String!
  type: ProductType!
  displayName: String
  displayPrice: String!
  currency: String!
  price: Float
  debugDescription: String
  platform: IapPlatform!

  # Android-specific
  nameAndroid: String!
  """
  One-time purchase offer details including discounts (Android)
  Returns all eligible offers. Available in Google Play Billing Library 7.0+
  """
  oneTimePurchaseOfferDetailsAndroid: [ProductAndroidOneTimePurchaseOfferDetail!]
  subscriptionOfferDetailsAndroid: [ProductSubscriptionAndroidOfferDetails!]!
}

type PurchaseAndroid implements PurchaseCommon {
  # Common fields
  id: ID!
  productId: String!
  ids: [String!]
  transactionId: String # Optional in Android unlike iOS
  transactionDate: Float!
  purchaseToken: String
  """
  Store where purchase was made
  """
  store: IapStore!
  platform: IapPlatform! @deprecated(reason: "Use store instead")
  quantity: Int!
  purchaseState: PurchaseState!
  isAutoRenewing: Boolean!
  currentPlanId: String

  # Android-specific fields
  dataAndroid: String
  signatureAndroid: String
  autoRenewingAndroid: Boolean
  isAcknowledgedAndroid: Boolean
  packageNameAndroid: String
  developerPayloadAndroid: String
  obfuscatedAccountIdAndroid: String
  obfuscatedProfileIdAndroid: String
  """
  Whether the subscription is suspended (Android)
  A suspended subscription means the user's payment method failed and they need to fix it.
  Users should be directed to the subscription center to resolve the issue.
  Do NOT grant entitlements for suspended subscriptions.
  Available in Google Play Billing Library 8.1.0+
  """
  isSuspendedAndroid: Boolean
}

# Android inputs
input RequestPurchaseAndroidProps {
  """
  List of product SKUs
  """
  skus: [String!]!
  """
  Obfuscated account ID
  """
  obfuscatedAccountIdAndroid: String
  """
  Obfuscated profile ID
  """
  obfuscatedProfileIdAndroid: String
  """
  Personalized offer flag
  """
  isOfferPersonalized: Boolean
}

input RequestSubscriptionAndroidProps {
  """
  List of subscription SKUs
  """
  skus: [String!]!
  """
  Obfuscated account ID
  """
  obfuscatedAccountIdAndroid: String
  """
  Obfuscated profile ID
  """
  obfuscatedProfileIdAndroid: String
  """
  Personalized offer flag
  """
  isOfferPersonalized: Boolean
  """
  Purchase token for upgrades/downgrades
  """
  purchaseTokenAndroid: String
  """
  Replacement mode for subscription changes
  """
  replacementModeAndroid: Int
  """
  Subscription offers
  """
  subscriptionOffers: [AndroidSubscriptionOfferInput!]
}

input AndroidSubscriptionOfferInput {
  """
  Product SKU
  """
  sku: String!
  """
  Offer token
  """
  offerToken: String!
}

input VerifyPurchaseAndroidOptions {
  packageName: String!
  productToken: String!
  accessToken: String!
  isSub: Boolean
}

type VerifyPurchaseResultAndroid {
  autoRenewing: Boolean!
  betaProduct: Boolean!
  cancelDate: Float
  cancelReason: String
  deferredDate: Float
  deferredSku: String
  freeTrialEndDate: Float!
  gracePeriodEndDate: Float!
  parentProductId: String!
  productId: String!
  productType: String!
  purchaseDate: Float!
  quantity: Int!
  receiptId: String!
  renewalDate: Float!
  term: String!
  termSku: String!
  testTransaction: Boolean!
}

# Alternative Billing
"""
Alternative billing mode for Android
Controls which billing system is used
"""
enum AlternativeBillingModeAndroid {
  """
  Standard Google Play billing (default)
  """
  NONE

  """
  User choice billing - user can select between Google Play or alternative
  Requires Google Play Billing Library 7.0+
  """
  USER_CHOICE

  """
  Alternative billing only - no Google Play billing option
  Requires Google Play Billing Library 6.2+
  """
  ALTERNATIVE_ONLY
}

# User Choice Billing
"""
User Choice Billing event details (Android)
Fired when a user selects alternative billing in the User Choice Billing dialog
"""
type UserChoiceBillingDetails {
  """
  Token that must be reported to Google Play within 24 hours
  """
  externalTransactionToken: String!
  """
  List of product IDs selected by the user
  """
  products: [String!]!
}
