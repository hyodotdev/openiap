# iOS-specific API operations

extend type Query {
  """
  Get the current App Store storefront country code
  """
  # Future
  getStorefrontIOS: String! @deprecated(reason: "Use getStorefront")
  """
  Get the currently promoted product (iOS 11+)
  """
  # Future
  getPromotedProductIOS: ProductIOS
  """
  Check if external purchase notice sheet can be presented (iOS 17.4+)
  Uses ExternalPurchase.canPresent
  """
  # Future
  canPresentExternalPurchaseNoticeIOS: Boolean!
  """
  Check if app is eligible for ExternalPurchaseCustomLink API (iOS 18.1+).
  Returns true if the app can use custom external purchase links.
  Reference: https://developer.apple.com/documentation/storekit/externalpurchasecustomlink/iseligible
  """
  # Future
  isEligibleForExternalPurchaseCustomLinkIOS: Boolean!
  """
  Get external purchase token for reporting to Apple (iOS 18.1+).
  Use this token with Apple's External Purchase Server API to report transactions.
  Reference: https://developer.apple.com/documentation/storekit/externalpurchasecustomlink/token(for:)
  """
  # Future
  getExternalPurchaseCustomLinkTokenIOS(
    """
    Token type: acquisition (new customers) or services (existing customers)
    """
    tokenType: ExternalPurchaseCustomLinkTokenTypeIOS!
  ): ExternalPurchaseCustomLinkTokenResultIOS!
  """
  Retrieve all pending transactions in the StoreKit queue
  """
  # Future
  getPendingTransactionsIOS: [PurchaseIOS!]!
  """
  Check introductory offer eligibility for a subscription group
  """
  # Future
  isEligibleForIntroOfferIOS(groupID: String!): Boolean!
  """
  Get StoreKit 2 subscription status details (iOS 15+)
  """
  # Future
  subscriptionStatusIOS(sku: String!): [SubscriptionStatusIOS!]!
  """
  Get current StoreKit 2 entitlements (iOS 15+)
  """
  # Future
  currentEntitlementIOS(sku: String!): PurchaseIOS
  """
  Get the latest transaction for a product using StoreKit 2
  """
  # Future
  latestTransactionIOS(sku: String!): PurchaseIOS
  """
  Verify a StoreKit 2 transaction signature
  """
  # Future
  isTransactionVerifiedIOS(sku: String!): Boolean!
  """
  Get the transaction JWS (StoreKit 2)
  """
  # Future
  getTransactionJwsIOS(sku: String!): String
  """
  Get base64-encoded receipt data for validation
  """
  # Future
  getReceiptDataIOS: String
  """
  Fetch the current app transaction (iOS 16+)
  """
  # Future
  getAppTransactionIOS: AppTransaction
"""
Validate a receipt for a specific product
"""
# Future
validateReceiptIOS(options: VerifyPurchaseProps!): VerifyPurchaseResultIOS! @deprecated(reason: "Use verifyPurchase")
}

extend type Mutation {
  """
  Clear pending transactions from the StoreKit payment queue
  """
  # Future
  clearTransactionIOS: Boolean!
  """
  Purchase the promoted product surfaced by the App Store.

  @deprecated Use promotedProductListenerIOS to receive the productId,
  then call requestPurchase with that SKU instead. In StoreKit 2,
  promoted products can be purchased directly via the standard purchase flow.
  """
  # Future
  requestPurchaseOnPromotedProductIOS: Boolean! @deprecated(reason: "Use promotedProductListenerIOS + requestPurchase instead")
  """
  Open subscription management UI and return changed purchases (iOS 15+)
  """
  # Future
  showManageSubscriptionsIOS: [PurchaseIOS!]!
  """
  Initiate a refund request for a product (iOS 15+)
  """
  # Future
  beginRefundRequestIOS(sku: String!): String
  """
  Force a StoreKit sync for transactions (iOS 15+)
  """
  # Future
  syncIOS: Boolean!
  """
  Present the App Store code redemption sheet
  """
  # Future
  presentCodeRedemptionSheetIOS: Boolean!
  """
  Present external purchase notice sheet (iOS 15.4+).
  Uses ExternalPurchase.presentNoticeSheet() which returns a token when user continues.
  Reference: https://developer.apple.com/documentation/storekit/externalpurchase/presentnoticesheet()
  """
  # Future
  presentExternalPurchaseNoticeSheetIOS: ExternalPurchaseNoticeResultIOS!
  """
  Present external purchase custom link with StoreKit UI
  """
  # Future
  presentExternalPurchaseLinkIOS(url: String!): ExternalPurchaseLinkResultIOS!
  """
  Show ExternalPurchaseCustomLink notice sheet (iOS 18.1+).
  Displays the system disclosure notice sheet for custom external purchase links.
  Call this after a deliberate customer interaction before linking out to external purchases.
  Reference: https://developer.apple.com/documentation/storekit/externalpurchasecustomlink/shownotice(type:)
  """
  # Future
  showExternalPurchaseCustomLinkNoticeIOS(
    """
    Notice type determining the style of disclosure
    """
    noticeType: ExternalPurchaseCustomLinkNoticeTypeIOS!
  ): ExternalPurchaseCustomLinkNoticeResultIOS!
}
